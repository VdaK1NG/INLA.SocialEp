[{"path":"https://vdak1ng.github.io/INLA.SocialEp/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Escobar-Hernández P., Palmí-Perales F. López-Quílez . Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Simulation Study - Data Creation","text":"      simulation going using US Counties belong main continental part. downloading official sources (US Census Bureau), need process spatial object. Specifically, need trim areas connected avoid possible problems may arise INLA approximation caused -fully connected graph underlying spatial effects. means removing Alaska non-continental states, well two island counties (San Juan Nantucket), leaving final number counties 3104.  going fix seed random numbers using number ARXIV page use average 100 observations per county, 25 per group equally distributed.       going assume two existing underlying risk factors may affect differently risk groups. One presents clear north-south gradient, simulated using mean temperatures last 24 months. second one presents diverse spatial pattern, concentrated around highly populated areas generated using population density. Moreover, going simulate baseline independent spatial effects, well heterogeneity effects.","code":"# Set seed for the simulation set.seed(241021227)  # Total Number of Observations total_obs <- n_county * 1000"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"baseline-risks","dir":"Articles","previous_headings":"Introduction","what":"Baseline Risks","title":"Simulation Study - Data Creation","text":"      Finally, also going consider two different possibilities one previous conditions: Different Risks: dataset presents severe differentes relative risk group. order make sure model able detect differences properly use dataset presents pronounced differences groups.  Similar Risks: complement previous option simulate two groups fairly similar relative risk.","code":"# Different Risks us_counties$group1_dif_risk <- rnorm(n_county, 0.3, 0.5) us_counties$group2_dif_risk <- rnorm(n_county, 0.05, 0.5) us_counties$group3_dif_risk <- rnorm(n_county, -0.3, 0.5) us_counties$group4_dif_risk <- rnorm(n_county, -0.05, 0.5) # Similar Risks us_counties$group1_sim_risk <- rnorm(n_county, 0, 0.5) us_counties$group2_sim_risk <- rnorm(n_county, 0, 0.5) us_counties$group3_sim_risk <- rnorm(n_county, 0, 0.5) us_counties$group4_sim_risk <- rnorm(n_county, 0, 0.5)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-1-temperature","dir":"Articles","previous_headings":"Introduction","what":"Factor 1: Temperature","title":"Simulation Study - Data Creation","text":"      Mean temperature months January 2023 January 2025 extracted official sources. Data around 100 missing values filled using mean temperature across counties. addition, values scaled oscillate 0.5 1.5 similar scale rest values used. final distribution values following:","code":"# Load temp data temp_data <- temp_data_us_23 temp_data <- temp_data %>% select(Name, State, Value) %>% mutate(STATE_NAME=State, NAMELSAD=Name) %>% select(-State, -Name)  # Merge datasets us_counties <- left_join(us_counties, temp_data) us_counties$Value[is.na(us_counties$Value)] <- mean(us_counties$Value, na.rm = TRUE) us_counties$Temp_Scale <- scale(us_counties$Value) summary(us_counties$Temp_Scale) ##        V1           ##  Min.   :-2.41479   ##  1st Qu.:-0.75341   ##  Median :-0.09636   ##  Mean   : 0.00000   ##  3rd Qu.: 0.76249   ##  Max.   : 3.41413"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-2-population-density","dir":"Articles","previous_headings":"Introduction","what":"Factor 2: Population Density","title":"Simulation Study - Data Creation","text":"      Population estimates 2023 obtained official sources. generate population density values used area land included shapefile downloaded census.gov web. values scaled well.","code":"# Load population data cov_data <- pop_data_us_23  cov_data <- cov_data %>% select(STNAME, CTYNAME, POPESTIMATE2023) %>% mutate(STATE_NAME=STNAME, NAMELSAD=CTYNAME) %>% select(-STNAME, -CTYNAME) cov_data <- cov_data[!duplicated(cov_data), ]  # Merge datasets us_counties <- left_join(us_counties, cov_data) us_counties$POPESTIMATE2023[us_counties$NAMELSAD==\"Doña Ana County\"] <- 225210 us_counties$POP_DENS <- us_counties$POPESTIMATE2023/us_counties$ALAND us_counties$POP_DENS_Scale <- scale(log(us_counties$POP_DENS))  summary(us_counties$POP_DENS_Scale) ##        V1            ##  Min.   :-3.710532   ##  1st Qu.:-0.558221   ##  Median :-0.004318   ##  Mean   : 0.000000   ##  3rd Qu.: 0.554702   ##  Max.   : 4.149420 # Extract Population variable for use later POP <- us_counties$POPESTIMATE2023"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"independent-spatial-effects","dir":"Articles","previous_headings":"Introduction","what":"Independent Spatial Effects","title":"Simulation Study - Data Creation","text":"      case need simulate 4 different spatial effects using function rst() package SUMMER.","code":"sim_sp_ef <- rst(n=4, type = \"s\", type.s = \"ICAR\", scale.model = FALSE, Amat = W)  ind.ef.g1 <- ind.ef[1, ] ind.ef.g2 <- ind.ef[2, ] ind.ef.g3 <- ind.ef[3, ] ind.ef.g4 <- ind.ef[4, ]"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"no-spatial-effect","dir":"Articles","previous_headings":"","what":"No Spatial Effect","title":"Simulation Study - Data Creation","text":"      case going assign values using population heterogeneity effect simulated group. θ1i=ω1iθ2i=ω2iθ3i=ω3iθ4i=ω4i \\begin{aligned} & \\theta_1^=\\omega_1^\\\\ & \\theta_2^=\\omega_2^\\\\ & \\theta_3^=\\omega_3^\\\\ & \\theta_4^=\\omega_4^\\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks","dir":"Articles","previous_headings":"No Spatial Effect","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate expected values depending on the population of the county (equal for all model used) total_pob <- sum(POP) EXP <- rep((total_obs*POP)/(total_pob*4), 4)  # Estimate the total combination of population and risks total_pobrisk <- sum(POP * us_counties$group1_sim_risk + POP * us_counties$group2_sim_risk +                         POP * us_counties$group3_sim_risk + POP * us_counties$group4_sim_risk)  # Add observed values to sp object for ploting us_counties$OBS_M0_SIM_G1 <- round(total_obs*((POP * us_counties$group1_sim_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G2 <- round(total_obs*((POP * us_counties$group2_sim_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G3 <- round(total_obs*((POP * us_counties$group3_sim_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G4 <- round(total_obs*((POP * us_counties$group4_sim_risk)/(total_pobrisk)), 0)  # Estimate underlying risk for each group g1_prk <- us_counties$group1_sim_risk g2_prk <- us_counties$group2_sim_risk g3_prk <- us_counties$group3_sim_risk  g4_prk <- us_counties$group4_sim_risk  # Exponential of the underlying risk to match log of the linear predictor g1_prk <- exp(g1_prk) g2_prk <- exp(g2_prk) g3_prk <- exp(g3_prk) g4_prk <- exp(g4_prk)  data_risk <- data.frame(\"M0_SIM\"=c(g1_prk, g2_prk, g3_prk, g4_prk))  # Estimate the total combination of population and risks total_pobrisk <- sum(POP * g1_prk + POP * g2_prk + POP * g3_prk + POP * g4_prk)  # Add observed values to sp object for ploting us_counties$OBS_M0_SIM_G1 <- round(total_obs*((POP * g1_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G2 <- round(total_obs*((POP * g2_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G3 <- round(total_obs*((POP * g3_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_SIM_G4 <- round(total_obs*((POP * g4_prk)/(total_pobrisk)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M0_df <- data.frame(\"OBS_SIM\"=NA, \"OBS_DIF\"=NA, \"EXP\"=EXP, TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M0_df$OBS_SIM <- c(us_counties$OBS_M0_SIM_G1, us_counties$OBS_M0_SIM_G2, us_counties$OBS_M0_SIM_G3, us_counties$OBS_M0_SIM_G4)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif <- sum(EXP)-sum(M0_df$OBS_SIM)  if(total_dif>0){   r_ids <- round(runif(total_dif, 1, nrow(M0_df)), 0)   M0_df$OBS_SIM[r_ids] <- M0_df$OBS_SIM[r_ids] + 1 }else if(total_dif<0){   r_ids <- round(runif(abs(total_dif), 1, nrow(M0_df)), 0)   M0_df$OBS_SIM[r_ids] <- M0_df$OBS_SIM[r_ids] - 1 }  if(sum(M0_df$OBS_SIM)!=total_obs){warning(\"Observed values and expected values do not match.\")}"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks","dir":"Articles","previous_headings":"No Spatial Effect","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate the total combination of population and risks total_pobrisk <- sum(POP * us_counties$group1_dif_risk + POP * us_counties$group2_dif_risk +                         POP * us_counties$group3_dif_risk + POP * us_counties$group4_dif_risk)  # Add observed values to sp object for ploting us_counties$OBS_M0_DIF_G1 <- round(total_obs*((POP * us_counties$group1_dif_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G2 <- round(total_obs*((POP * us_counties$group2_dif_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G3 <- round(total_obs*((POP * us_counties$group3_dif_risk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G4 <- round(total_obs*((POP * us_counties$group4_dif_risk)/(total_pobrisk)), 0)  # Estimate underlying risk for each group g1_prk <- us_counties$group1_dif_risk g2_prk <- us_counties$group2_dif_risk g3_prk <- us_counties$group3_dif_risk  g4_prk <- us_counties$group4_dif_risk  # Exponential of the underlying risk to match log of the linear predictor g1_prk <- exp(g1_prk) g2_prk <- exp(g2_prk) g3_prk <- exp(g3_prk) g4_prk <- exp(g4_prk)  data_risk$M0_DIF <- c(g1_prk, g2_prk, g3_prk, g4_prk)  # Estimate the total combination of population and risks total_pobrisk <- sum(POP * g1_prk + POP * g2_prk + POP * g3_prk + POP * g4_prk)  # Add observed values to sp object for ploting us_counties$OBS_M0_DIF_G1 <- round(total_obs*((POP * g1_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G2 <- round(total_obs*((POP * g2_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G3 <- round(total_obs*((POP * g3_prk)/(total_pobrisk)), 0) us_counties$OBS_M0_DIF_G4 <- round(total_obs*((POP * g4_prk)/(total_pobrisk)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M0_df$OBS_DIF <- c(us_counties$OBS_M0_DIF_G1, us_counties$OBS_M0_DIF_G2, us_counties$OBS_M0_DIF_G3, us_counties$OBS_M0_DIF_G4)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif <- sum(EXP)-sum(M0_df$OBS_DIF)  if(total_dif>0){   r_ids <- round(runif(total_dif, 1, nrow(M0_df)), 0)   M0_df$OBS_DIF[r_ids] <- M0_df$OBS_DIF[r_ids] + 1 }else if(total_dif<0){   r_ids <- round(runif(abs(total_dif), 1, nrow(M0_df)), 0)   M0_df$OBS_DIF[r_ids] <- M0_df$OBS_DIF[r_ids] - 1 }  if(sum(M0_df$OBS_DIF)!=total_obs){warning(\"Observed values and expected values do not match.\")}"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"individual-spatial-effects","dir":"Articles","previous_headings":"","what":"Individual Spatial Effects","title":"Simulation Study - Data Creation","text":"      case need simulate 4 different spatial effects using function rst() package SUMMER. spatial effect combined underlying risk assigned county group, used distribute number observed cases. rescale spatial effects -1 1 assigned risk groups dont go far . θ1i=γ11ω1i+γ21ϕ1θ2i=γ12ω2i+γ22ϕ2θ3i=γ13ω3i+γ23ϕ3θ4i=γ14ω4i+γ24ϕ4 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_1 \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_2 \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_3 \\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_4 \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-1","dir":"Articles","previous_headings":"Individual Spatial Effects","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_sim_risk + 1/2*ind.ef.g2 g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g1 g3_prk_v1 <- 1/2*us_counties$group3_sim_risk + 1/2*ind.ef.g3 g4_prk_v1 <- 1/2*us_counties$group4_sim_risk + 1/2*ind.ef.g4  g1_prk_v2 <- 2/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2 g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g1 g3_prk_v2 <- 2/3*us_counties$group3_sim_risk + 1/3*ind.ef.g3 g4_prk_v2 <- 2/3*us_counties$group4_sim_risk + 1/3*ind.ef.g4  g1_prk_v3 <- 1/3*us_counties$group1_sim_risk + 2/3*ind.ef.g2 g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g1 g3_prk_v3 <- 1/3*us_counties$group3_sim_risk + 2/3*ind.ef.g3 g4_prk_v3 <- 1/3*us_counties$group4_sim_risk + 2/3*ind.ef.g4  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M1_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M1_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M1_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M1_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M1_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M1_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M1_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA, \"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M1_df$OBS_SIM_v1 <- c(us_counties$OBS_M1_SIM_G1_v1, us_counties$OBS_M1_SIM_G2_v1, us_counties$OBS_M1_SIM_G3_v1, us_counties$OBS_M1_SIM_G4_v1) M1_df$OBS_SIM_v2 <- c(us_counties$OBS_M1_SIM_G1_v2, us_counties$OBS_M1_SIM_G2_v2, us_counties$OBS_M1_SIM_G3_v2, us_counties$OBS_M1_SIM_G4_v2) M1_df$OBS_SIM_v3 <- c(us_counties$OBS_M1_SIM_G1_v3, us_counties$OBS_M1_SIM_G2_v3, us_counties$OBS_M1_SIM_G3_v3, us_counties$OBS_M1_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M1_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M1_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M1_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- round(runif(total_dif_v1, 1, nrow(M1_df)), 0)   M1_df$OBS_SIM_v1[r_ids] <- M1_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- round(runif(abs(total_dif_v1), 1, nrow(M1_df)), 0)   M1_df$OBS_SIM_v1[r_ids] <- M1_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(nrow(M1_df), total_dif_v2)   M1_df$OBS_SIM_v2[r_ids] <- M1_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- round(runif(abs(total_dif_v2), 1, nrow(M1_df)), 0)   M1_df$OBS_SIM_v2[r_ids] <- M1_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- round(runif(total_dif_v3, 1, nrow(M1_df)), 0)   M1_df$OBS_SIM_v3[r_ids] <- M1_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- round(runif(abs(total_dif_v3), 1, nrow(M1_df)), 0)   M1_df$OBS_SIM_v3[r_ids] <- M1_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-1","dir":"Articles","previous_headings":"Individual Spatial Effects","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_dif_risk + 1/2*ind.ef.g2 g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g1 g3_prk_v1 <- 1/2*us_counties$group3_dif_risk + 1/2*ind.ef.g3 g4_prk_v1 <- 1/2*us_counties$group4_dif_risk + 1/2*ind.ef.g4  g1_prk_v2 <- 2/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2 g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g1 g3_prk_v2 <- 2/3*us_counties$group3_dif_risk + 1/3*ind.ef.g3 g4_prk_v2 <- 2/3*us_counties$group4_dif_risk + 1/3*ind.ef.g4  g1_prk_v3 <- 1/3*us_counties$group1_dif_risk + 2/3*ind.ef.g2 g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g1 g3_prk_v3 <- 1/3*us_counties$group3_dif_risk + 2/3*ind.ef.g3 g4_prk_v3 <- 1/3*us_counties$group4_dif_risk + 2/3*ind.ef.g4  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M1_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M1_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M1_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M1_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M1_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M1_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M1_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M1_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M1_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M1_df$OBS_DIF_v1 <- c(us_counties$OBS_M1_DIF_G1_v1, us_counties$OBS_M1_DIF_G2_v1, us_counties$OBS_M1_DIF_G3_v1, us_counties$OBS_M1_DIF_G4_v1) M1_df$OBS_DIF_v2 <- c(us_counties$OBS_M1_DIF_G1_v2, us_counties$OBS_M1_DIF_G2_v2, us_counties$OBS_M1_DIF_G3_v2, us_counties$OBS_M1_DIF_G4_v2) M1_df$OBS_DIF_v3 <- c(us_counties$OBS_M1_DIF_G1_v3, us_counties$OBS_M1_DIF_G2_v3, us_counties$OBS_M1_DIF_G3_v3, us_counties$OBS_M1_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M1_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M1_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M1_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v1))   M1_df$OBS_DIF_v1[r_ids] <- M1_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v1))   M1_df$OBS_DIF_v1[r_ids] <- M1_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v2))   M1_df$OBS_DIF_v2[r_ids] <- M1_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v2))   M1_df$OBS_DIF_v2[r_ids] <- M1_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v3))   M1_df$OBS_DIF_v3[r_ids] <- M1_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(nrow(M1_df), abs(total_dif_v3))   M1_df$OBS_DIF_v3[r_ids] <- M1_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"shared-spatial-effect","dir":"Articles","previous_headings":"","what":"Shared Spatial Effect","title":"Simulation Study - Data Creation","text":"θ1i=γ11ω1i+γ21ϕ11θ2i=γ12ω2i+γ22ϕ11θ3i=γ13ω3i+γ23ϕ11θ4i=γ14ω4i+γ24ϕ11 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_{11} \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_{11} \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_{11} \\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_{11} \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-2","dir":"Articles","previous_headings":"Shared Spatial Effect","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_sim_risk + 1/2*ind.ef.g2 g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/2*us_counties$group3_sim_risk + 1/2*ind.ef.g2 g4_prk_v1 <- 1/2*us_counties$group4_sim_risk + 1/2*ind.ef.g2  g1_prk_v2 <- 2/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2 g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 2/3*us_counties$group3_sim_risk + 1/3*ind.ef.g2 g4_prk_v2 <- 2/3*us_counties$group4_sim_risk + 1/3*ind.ef.g2  g1_prk_v3 <- 1/3*us_counties$group1_sim_risk + 2/3*ind.ef.g2 g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 1/3*us_counties$group3_sim_risk + 2/3*ind.ef.g2 g4_prk_v3 <- 1/3*us_counties$group4_sim_risk + 2/3*ind.ef.g2  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M2_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M2_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M2_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M2_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M2_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M2_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M2_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA,\"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M2_df$OBS_SIM_v1 <- c(us_counties$OBS_M2_SIM_G1_v1, us_counties$OBS_M2_SIM_G2_v1, us_counties$OBS_M2_SIM_G3_v1, us_counties$OBS_M2_SIM_G4_v1) M2_df$OBS_SIM_v2 <- c(us_counties$OBS_M2_SIM_G1_v2, us_counties$OBS_M2_SIM_G2_v2, us_counties$OBS_M2_SIM_G3_v2, us_counties$OBS_M2_SIM_G4_v2) M2_df$OBS_SIM_v3 <- c(us_counties$OBS_M2_SIM_G1_v3, us_counties$OBS_M2_SIM_G2_v3, us_counties$OBS_M2_SIM_G3_v3, us_counties$OBS_M2_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M2_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M2_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M2_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M2_df$OBS_SIM_v1[r_ids] <- M2_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M2_df$OBS_SIM_v1[r_ids] <- M2_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M2_df$OBS_SIM_v2[r_ids] <- M2_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M2_df$OBS_SIM_v2[r_ids] <- M2_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M2_df$OBS_SIM_v3[r_ids] <- M2_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M2_df$OBS_SIM_v3[r_ids] <- M2_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-2","dir":"Articles","previous_headings":"Shared Spatial Effect","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_dif_risk + 1/2*ind.ef.g2 g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/2*us_counties$group3_dif_risk + 1/2*ind.ef.g2 g4_prk_v1 <- 1/2*us_counties$group4_dif_risk + 1/2*ind.ef.g2  g1_prk_v2 <- 2/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2 g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 2/3*us_counties$group3_dif_risk + 1/3*ind.ef.g2 g4_prk_v2 <- 2/3*us_counties$group4_dif_risk + 1/3*ind.ef.g2  g1_prk_v3 <- 1/3*us_counties$group1_dif_risk + 2/3*ind.ef.g2 g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 1/3*us_counties$group3_dif_risk + 2/3*ind.ef.g2 g4_prk_v3 <- 1/3*us_counties$group4_dif_risk + 2/3*ind.ef.g2  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M2_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M2_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M2_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M2_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M2_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M2_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M2_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M2_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M2_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M2_df$OBS_DIF_v1 <- c(us_counties$OBS_M2_DIF_G1_v1, us_counties$OBS_M2_DIF_G2_v1, us_counties$OBS_M2_DIF_G3_v1, us_counties$OBS_M2_DIF_G4_v1) M2_df$OBS_DIF_v2 <- c(us_counties$OBS_M2_DIF_G1_v2, us_counties$OBS_M2_DIF_G2_v2, us_counties$OBS_M2_DIF_G3_v2, us_counties$OBS_M2_DIF_G4_v2) M2_df$OBS_DIF_v3 <- c(us_counties$OBS_M2_DIF_G1_v3, us_counties$OBS_M2_DIF_G2_v3, us_counties$OBS_M2_DIF_G3_v3, us_counties$OBS_M2_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M2_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M2_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M2_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M2_df$OBS_DIF_v1[r_ids] <- M2_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M2_df$OBS_DIF_v1[r_ids] <- M2_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M2_df$OBS_DIF_v2[r_ids] <- M2_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M2_df$OBS_DIF_v2[r_ids] <- M2_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M2_df$OBS_DIF_v3[r_ids] <- M2_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M2_df$OBS_DIF_v3[r_ids] <- M2_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-2-spatial-effect-rural-urban","dir":"Articles","previous_headings":"","what":"Factor 2 Spatial Effect (Rural-Urban)","title":"Simulation Study - Data Creation","text":"θ1i=γ11ω1i+γ21ϕ11θ2i=γ12ω2i+γ22ϕ11θ3i=γ13ω3i+γ23ϕ11+γ33ϕ21θ4i=γ14ω4i+γ24ϕ11+γ34ϕ21 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_{11} \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_{11} \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_{11} + \\gamma_3^3 \\phi_{21} \\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_{11} + \\gamma_3^4 \\phi_{21} \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-3","dir":"Articles","previous_headings":"Factor 2 Spatial Effect (Rural-Urban)","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_sim_risk + 1/2*ind.ef.g2  g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/3*us_counties$group3_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale g4_prk_v1 <- 1/3*us_counties$group4_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 2/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2  g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 14/25*us_counties$group3_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale g4_prk_v2 <- 14/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 1/3*us_counties$group1_sim_risk + 2/3*ind.ef.g2  g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 4/25*us_counties$group3_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale g4_prk_v3 <- 4/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M3_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M3_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M3_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M3_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M3_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M3_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M3_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA, \"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M3_df$OBS_SIM_v1 <- c(us_counties$OBS_M3_SIM_G1_v1, us_counties$OBS_M3_SIM_G2_v1, us_counties$OBS_M3_SIM_G3_v1, us_counties$OBS_M3_SIM_G4_v1) M3_df$OBS_SIM_v2 <- c(us_counties$OBS_M3_SIM_G1_v2, us_counties$OBS_M3_SIM_G2_v2, us_counties$OBS_M3_SIM_G3_v2, us_counties$OBS_M3_SIM_G4_v2) M3_df$OBS_SIM_v3 <- c(us_counties$OBS_M3_SIM_G1_v3, us_counties$OBS_M3_SIM_G2_v3, us_counties$OBS_M3_SIM_G3_v3, us_counties$OBS_M3_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M3_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M3_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M3_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v1))   M3_df$OBS_SIM_v1[r_ids] <- M3_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v1))   M3_df$OBS_SIM_v1[r_ids] <- M3_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v2))   M3_df$OBS_SIM_v2[r_ids] <- M3_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v2))   M3_df$OBS_SIM_v2[r_ids] <- M3_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v3))   M3_df$OBS_SIM_v3[r_ids] <- M3_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M3_df), abs(total_dif_v3))   M3_df$OBS_SIM_v3[r_ids] <- M3_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-3","dir":"Articles","previous_headings":"Factor 2 Spatial Effect (Rural-Urban)","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/2*us_counties$group1_dif_risk + 1/2*ind.ef.g2  g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/3*us_counties$group3_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale g4_prk_v1 <- 1/3*us_counties$group4_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 2/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2  g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 14/25*us_counties$group3_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale g4_prk_v2 <- 14/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 1/3*us_counties$group1_dif_risk + 2/3*ind.ef.g2  g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 4/25*us_counties$group3_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale g4_prk_v3 <- 4/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M3_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M3_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M3_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M3_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M3_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M3_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M3_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M3_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M3_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M3_df$OBS_DIF_v1 <- c(us_counties$OBS_M3_DIF_G1_v1, us_counties$OBS_M3_DIF_G2_v1, us_counties$OBS_M3_DIF_G3_v1, us_counties$OBS_M3_DIF_G4_v1) M3_df$OBS_DIF_v2 <- c(us_counties$OBS_M3_DIF_G1_v2, us_counties$OBS_M3_DIF_G2_v2, us_counties$OBS_M3_DIF_G3_v2, us_counties$OBS_M3_DIF_G4_v2) M3_df$OBS_DIF_v3 <- c(us_counties$OBS_M3_DIF_G1_v3, us_counties$OBS_M3_DIF_G2_v3, us_counties$OBS_M3_DIF_G3_v3, us_counties$OBS_M3_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M3_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M3_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M3_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M3_df$OBS_DIF_v1[r_ids] <- M3_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M3_df$OBS_DIF_v1[r_ids] <- M3_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M3_df$OBS_DIF_v2[r_ids] <- M3_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M3_df$OBS_DIF_v2[r_ids] <- M3_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M3_df$OBS_DIF_v3[r_ids] <- M3_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M3_df$OBS_DIF_v3[r_ids] <- M3_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-2-spatial-effect-north-south","dir":"Articles","previous_headings":"","what":"Factor 2 Spatial Effect (North-South)","title":"Simulation Study - Data Creation","text":"θ1i=γ11ω1i+γ21ϕ11θ2i=γ12ω2i+γ22ϕ11+γ32ϕ12θ3i=γ13ω3i+γ23ϕ11θ4i=γ14ω4i+γ24ϕ11+γ34ϕ12 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_{11} \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_{11} + \\gamma_3^2 \\phi_{12} \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_{11} \\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_{11} + \\gamma_3^4 \\phi_{12}  \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-4","dir":"Articles","previous_headings":"Factor 2 Spatial Effect (North-South)","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/3*us_counties$group3_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g4_prk_v1 <- 1/2*us_counties$group4_sim_risk + 1/2*ind.ef.g2  g1_prk_v2 <- 14/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 14/25*us_counties$group3_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g4_prk_v2 <- 2/3*us_counties$group4_sim_risk + 1/3*ind.ef.g2  g1_prk_v3 <- 4/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 4/25*us_counties$group3_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g4_prk_v3 <- 1/3*us_counties$group4_sim_risk + 2/3*ind.ef.g2  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M4_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M4_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M4_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M4_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M4_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M4_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M4_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA, \"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M4_df$OBS_SIM_v1 <- c(us_counties$OBS_M4_SIM_G1_v1, us_counties$OBS_M4_SIM_G2_v1, us_counties$OBS_M4_SIM_G3_v1, us_counties$OBS_M4_SIM_G4_v1) M4_df$OBS_SIM_v2 <- c(us_counties$OBS_M4_SIM_G1_v2, us_counties$OBS_M4_SIM_G2_v2, us_counties$OBS_M4_SIM_G3_v2, us_counties$OBS_M4_SIM_G4_v2) M4_df$OBS_SIM_v3 <- c(us_counties$OBS_M4_SIM_G1_v3, us_counties$OBS_M4_SIM_G2_v3, us_counties$OBS_M4_SIM_G3_v3, us_counties$OBS_M4_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M4_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M4_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M4_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v1))   M4_df$OBS_SIM_v1[r_ids] <- M4_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v1))   M4_df$OBS_SIM_v1[r_ids] <- M4_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v2))   M4_df$OBS_SIM_v2[r_ids] <- M4_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v2))   M4_df$OBS_SIM_v2[r_ids] <- M4_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v3))   M4_df$OBS_SIM_v3[r_ids] <- M4_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v3))   M4_df$OBS_SIM_v3[r_ids] <- M4_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-4","dir":"Articles","previous_headings":"Factor 2 Spatial Effect (North-South)","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/3*us_counties$group3_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g4_prk_v1 <- 1/2*us_counties$group4_dif_risk + 1/2*ind.ef.g2  g1_prk_v2 <- 14/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 14/25*us_counties$group3_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g4_prk_v2 <- 2/3*us_counties$group4_dif_risk + 1/3*ind.ef.g2  g1_prk_v3 <- 4/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 4/25*us_counties$group3_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g4_prk_v3 <- 1/3*us_counties$group4_dif_risk + 2/3*ind.ef.g2  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M4_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M4_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M4_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M4_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M4_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M4_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M4_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M4_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M4_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M4_df$OBS_DIF_v1 <- c(us_counties$OBS_M4_DIF_G1_v1, us_counties$OBS_M4_DIF_G2_v1, us_counties$OBS_M4_DIF_G3_v1, us_counties$OBS_M4_DIF_G4_v1) M4_df$OBS_DIF_v2 <- c(us_counties$OBS_M4_DIF_G1_v2, us_counties$OBS_M4_DIF_G2_v2, us_counties$OBS_M4_DIF_G3_v2, us_counties$OBS_M4_DIF_G4_v2) M4_df$OBS_DIF_v3 <- c(us_counties$OBS_M4_DIF_G1_v3, us_counties$OBS_M4_DIF_G2_v3, us_counties$OBS_M4_DIF_G3_v3, us_counties$OBS_M4_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M4_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M4_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M4_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v1))   M4_df$OBS_DIF_v1[r_ids] <- M4_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v1))   M4_df$OBS_DIF_v1[r_ids] <- M4_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v2))   M4_df$OBS_DIF_v2[r_ids] <- M4_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v2))   M4_df$OBS_DIF_v2[r_ids] <- M4_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v3))   M4_df$OBS_DIF_v3[r_ids] <- M4_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M4_df), abs(total_dif_v3))   M4_df$OBS_DIF_v3[r_ids] <- M4_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-1-factor-2","dir":"Articles","previous_headings":"","what":"Factor 1 + Factor 2","title":"Simulation Study - Data Creation","text":"θ1i=γ11ω1i+γ21ϕ11θ2i=γ12ω2i+γ22ϕ11+γ32ϕ12θ3i=γ13ω3i+γ23ϕ11+γ33ϕ21θ4i=γ14ω4i+γ24ϕ11+γ34ϕ12+γ44ϕ21 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_{11} \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_{11} + \\gamma_3^2 \\phi_{12} \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_{11} + \\gamma_3^3 \\phi_{21} \\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_{11} + \\gamma_3^4 \\phi_{12} + \\gamma_4^4 \\phi_{21} \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-5","dir":"Articles","previous_headings":"Factor 1 + Factor 2","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/4*us_counties$group3_sim_risk + 1/4*ind.ef.g2 + 1/4*us_counties$POP_DENS_Scale + 1/4*us_counties$Temp_Scale g4_prk_v1 <- 1/3*us_counties$group4_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 14/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 53/100*us_counties$group3_sim_risk + 26/100*ind.ef.g2 + 13/100*us_counties$POP_DENS_Scale + 8/100*us_counties$Temp_Scale g4_prk_v2 <- 14/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 4/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 8/100*us_counties$group3_sim_risk + 53/100*ind.ef.g2 + 26/100*us_counties$POP_DENS_Scale + 13/100*us_counties$Temp_Scale g4_prk_v3 <- 4/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M5_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M5_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M5_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M5_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M5_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M5_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M5_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA, \"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M5_df$OBS_SIM_v1 <- c(us_counties$OBS_M5_SIM_G1_v1, us_counties$OBS_M5_SIM_G2_v1, us_counties$OBS_M5_SIM_G3_v1, us_counties$OBS_M5_SIM_G4_v1) M5_df$OBS_SIM_v2 <- c(us_counties$OBS_M5_SIM_G1_v2, us_counties$OBS_M5_SIM_G2_v2, us_counties$OBS_M5_SIM_G3_v2, us_counties$OBS_M5_SIM_G4_v2) M5_df$OBS_SIM_v3 <- c(us_counties$OBS_M5_SIM_G1_v3, us_counties$OBS_M5_SIM_G2_v3, us_counties$OBS_M5_SIM_G3_v3, us_counties$OBS_M5_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M5_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M5_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M5_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M5_df$OBS_SIM_v1[r_ids] <- M5_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M5_df$OBS_SIM_v1[r_ids] <- M5_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M5_df$OBS_SIM_v2[r_ids] <- M5_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M5_df$OBS_SIM_v2[r_ids] <- M5_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M5_df$OBS_SIM_v3[r_ids] <- M5_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M5_df$OBS_SIM_v3[r_ids] <- M5_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-5","dir":"Articles","previous_headings":"Factor 1 + Factor 2","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/4*us_counties$group3_dif_risk + 1/4*ind.ef.g2 + 1/4*us_counties$POP_DENS_Scale + 1/4*us_counties$Temp_Scale g4_prk_v1 <- 1/3*us_counties$group4_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 14/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 53/100*us_counties$group3_dif_risk + 26/100*ind.ef.g2 + 13/100*us_counties$POP_DENS_Scale + 8/100*us_counties$Temp_Scale g4_prk_v2 <- 14/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 4/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 8/100*us_counties$group3_dif_risk + 53/100*ind.ef.g2 + 26/100*us_counties$POP_DENS_Scale + 13/100*us_counties$Temp_Scale g4_prk_v3 <- 4/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M5_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M5_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M5_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M5_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M5_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M5_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M5_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M5_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M5_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M5_df$OBS_DIF_v1 <- c(us_counties$OBS_M5_DIF_G1_v1, us_counties$OBS_M5_DIF_G2_v1, us_counties$OBS_M5_DIF_G3_v1, us_counties$OBS_M5_DIF_G4_v1) M5_df$OBS_DIF_v2 <- c(us_counties$OBS_M5_DIF_G1_v2, us_counties$OBS_M5_DIF_G2_v2, us_counties$OBS_M5_DIF_G3_v2, us_counties$OBS_M5_DIF_G4_v2) M5_df$OBS_DIF_v3 <- c(us_counties$OBS_M5_DIF_G1_v3, us_counties$OBS_M5_DIF_G2_v3, us_counties$OBS_M5_DIF_G3_v3, us_counties$OBS_M5_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M5_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M5_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M5_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M5_df$OBS_DIF_v1[r_ids] <- M5_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M5_df$OBS_DIF_v1[r_ids] <- M5_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M5_df$OBS_DIF_v2[r_ids] <- M5_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M5_df$OBS_DIF_v2[r_ids] <- M5_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M5_df$OBS_DIF_v3[r_ids] <- M5_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M5_df$OBS_DIF_v3[r_ids] <- M5_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"factor-1-factor-2-1","dir":"Articles","previous_headings":"","what":"Factor 1 * Factor 2","title":"Simulation Study - Data Creation","text":"θ1i=γ11ω1i+γ21ϕ11θ2i=γ12ω2i+γ22ϕ11+γ32ϕ12θ3i=γ13ω3i+γ23ϕ11+γ33ϕ21+γ44ϕ21θ4i=γ14ω4i+γ24ϕ11+γ34ϕ12+γ44ϕ22 \\begin{aligned} & \\theta_1^=\\gamma_1^1 \\omega_1^+ \\gamma_2^1 \\phi_{11} \\\\ & \\theta_2^=\\gamma_1^2 \\omega_2^+ \\gamma_2^2 \\phi_{11} + \\gamma_3^2 \\phi_{12} \\\\ & \\theta_3^=\\gamma_1^3 \\omega_3^+ \\gamma_2^3 \\phi_{11} + \\gamma_3^3 \\phi_{21} + \\gamma_4^4 \\phi_{21}\\\\ & \\theta_4^=\\gamma_1^4 \\omega_4^+ \\gamma_2^4 \\phi_{11} + \\gamma_3^4 \\phi_{12} + \\gamma_4^4 \\phi_{22} \\end{aligned}","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-equal-risks-6","dir":"Articles","previous_headings":"Factor 1 * Factor 2","what":"Groups with equal risks","title":"Simulation Study - Data Creation","text":"","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_sim_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/4*us_counties$group3_sim_risk + 1/4*ind.ef.g2 + 1/4*ind.ef.g1 + 1/4*us_counties$Temp_Scale g4_prk_v1 <- 1/3*us_counties$group4_sim_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 14/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_sim_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 53/100*us_counties$group3_sim_risk + 26/100*ind.ef.g2 + 13/100*ind.ef.g1 + 8/100*us_counties$Temp_Scale g4_prk_v2 <- 14/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 4/25*us_counties$group1_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_sim_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 8/100*us_counties$group3_sim_risk + 53/100*ind.ef.g2 + 26/100*ind.ef.g1 + 13/100*us_counties$Temp_Scale g4_prk_v3 <- 4/25*us_counties$group4_sim_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M6_SIM_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M6_SIM_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M6_SIM_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M6_SIM_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_SIM_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_SIM_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_SIM_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M6_SIM_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_SIM_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_SIM_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_SIM_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M6_SIM_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_SIM_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_SIM_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_SIM_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M6_df <- data.frame(\"OBS_SIM_v1\"=NA, \"OBS_DIF_v1\"=NA, \"OBS_SIM_v2\"=NA, \"OBS_DIF_v2\"=NA, \"OBS_SIM_v3\"=NA, \"OBS_DIF_v3\"=NA, \"EXP\"=EXP,                      TYPE = c(rep(c(\"G1\", \"G2\", \"G3\", \"G4\"), each=nrow(us_counties))), \"idx\"=1:length(EXP)) M6_df$OBS_SIM_v1 <- c(us_counties$OBS_M6_SIM_G1_v1, us_counties$OBS_M6_SIM_G2_v1, us_counties$OBS_M6_SIM_G3_v1, us_counties$OBS_M6_SIM_G4_v1) M6_df$OBS_SIM_v2 <- c(us_counties$OBS_M6_SIM_G1_v2, us_counties$OBS_M6_SIM_G2_v2, us_counties$OBS_M6_SIM_G3_v2, us_counties$OBS_M6_SIM_G4_v2) M6_df$OBS_SIM_v3 <- c(us_counties$OBS_M6_SIM_G1_v3, us_counties$OBS_M6_SIM_G2_v3, us_counties$OBS_M6_SIM_G3_v3, us_counties$OBS_M6_SIM_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M6_df$OBS_SIM_v1) total_dif_v2 <- sum(EXP)-sum(M6_df$OBS_SIM_v2) total_dif_v3 <- sum(EXP)-sum(M6_df$OBS_SIM_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M6_df$OBS_SIM_v1[r_ids] <- M6_df$OBS_SIM_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M6_df$OBS_SIM_v1[r_ids] <- M6_df$OBS_SIM_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M6_df$OBS_SIM_v2[r_ids] <- M6_df$OBS_SIM_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M6_df$OBS_SIM_v2[r_ids] <- M6_df$OBS_SIM_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M6_df$OBS_SIM_v3[r_ids] <- M6_df$OBS_SIM_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M6_df$OBS_SIM_v3[r_ids] <- M6_df$OBS_SIM_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"groups-with-different-risks-6","dir":"Articles","previous_headings":"Factor 1 * Factor 2","what":"Groups with different risks","title":"Simulation Study - Data Creation","text":"      Just like previous section, generate underlying risks adding underlying simulated risk county group different spatial effect. following figure represents final rates dividing number cases among counties using total risk assigned.","code":"# Estimate underlying risk for each group g1_prk_v1 <- 1/3*us_counties$group1_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$Temp_Scale g2_prk_v1 <- 1/2*us_counties$group2_dif_risk + 1/2*ind.ef.g2 g3_prk_v1 <- 1/4*us_counties$group3_dif_risk + 1/4*ind.ef.g2 + 1/4*ind.ef.g1 + 1/4*us_counties$Temp_Scale g4_prk_v1 <- 1/3*us_counties$group4_dif_risk + 1/3*ind.ef.g2 + 1/3*us_counties$POP_DENS_Scale  g1_prk_v2 <- 14/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$Temp_Scale g2_prk_v2 <- 2/3*us_counties$group2_dif_risk + 1/3*ind.ef.g2 g3_prk_v2 <- 53/100*us_counties$group3_dif_risk + 26/100*ind.ef.g2 + 13/100*ind.ef.g1 + 8/100*us_counties$Temp_Scale g4_prk_v2 <- 14/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 4/25*us_counties$POP_DENS_Scale  g1_prk_v3 <- 4/25*us_counties$group1_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$Temp_Scale g2_prk_v3 <- 1/3*us_counties$group2_dif_risk + 2/3*ind.ef.g2 g3_prk_v3 <- 8/100*us_counties$group3_dif_risk + 53/100*ind.ef.g2 + 26/100*ind.ef.g1 + 13/100*us_counties$Temp_Scale g4_prk_v3 <- 4/25*us_counties$group4_dif_risk + 7/25*ind.ef.g2 + 14/25*us_counties$POP_DENS_Scale  # Exponential of the underlying risk to match log of the linear predictor g1_prk_v1 <- exp(g1_prk_v1) g2_prk_v1 <- exp(g2_prk_v1) g3_prk_v1 <- exp(g3_prk_v1) g4_prk_v1 <- exp(g4_prk_v1)  g1_prk_v2 <- exp(g1_prk_v2) g2_prk_v2 <- exp(g2_prk_v2) g3_prk_v2 <- exp(g3_prk_v2) g4_prk_v2 <- exp(g4_prk_v2)  g1_prk_v3 <- exp(g1_prk_v3) g2_prk_v3 <- exp(g2_prk_v3) g3_prk_v3 <- exp(g3_prk_v3) g4_prk_v3 <- exp(g4_prk_v3)  data_risk$M6_DIF_V1 <- c(g1_prk_v1, g2_prk_v1, g3_prk_v1, g4_prk_v1) data_risk$M6_DIF_V2 <- c(g1_prk_v2, g2_prk_v2, g3_prk_v2, g4_prk_v2) data_risk$M6_DIF_V3 <- c(g1_prk_v3, g2_prk_v3, g3_prk_v3, g4_prk_v3)  # Estimate the total combination of population and risks total_pobrisk_v1 <- sum(POP * g1_prk_v1 + POP * g2_prk_v1 + POP * g3_prk_v1 + POP * g4_prk_v1) total_pobrisk_v2 <- sum(POP * g1_prk_v2 + POP * g2_prk_v2 + POP * g3_prk_v2 + POP * g4_prk_v2) total_pobrisk_v3 <- sum(POP * g1_prk_v3 + POP * g2_prk_v3 + POP * g3_prk_v3 + POP * g4_prk_v3)  # Add observed values to sp object for ploting us_counties$OBS_M6_DIF_G1_v1 <- round(total_obs*((POP * g1_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_DIF_G2_v1 <- round(total_obs*((POP * g2_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_DIF_G3_v1 <- round(total_obs*((POP * g3_prk_v1)/(total_pobrisk_v1)), 0) us_counties$OBS_M6_DIF_G4_v1 <- round(total_obs*((POP * g4_prk_v1)/(total_pobrisk_v1)), 0)  us_counties$OBS_M6_DIF_G1_v2 <- round(total_obs*((POP * g1_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_DIF_G2_v2 <- round(total_obs*((POP * g2_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_DIF_G3_v2 <- round(total_obs*((POP * g3_prk_v2)/(total_pobrisk_v2)), 0) us_counties$OBS_M6_DIF_G4_v2 <- round(total_obs*((POP * g4_prk_v2)/(total_pobrisk_v2)), 0)  us_counties$OBS_M6_DIF_G1_v3 <- round(total_obs*((POP * g1_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_DIF_G2_v3 <- round(total_obs*((POP * g2_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_DIF_G3_v3 <- round(total_obs*((POP * g3_prk_v3)/(total_pobrisk_v3)), 0) us_counties$OBS_M6_DIF_G4_v3 <- round(total_obs*((POP * g4_prk_v3)/(total_pobrisk_v3)), 0)  # Create dataframe for M0 models and estimate observed values depending on risks M6_df$OBS_DIF_v1 <- c(us_counties$OBS_M6_DIF_G1_v1, us_counties$OBS_M6_DIF_G2_v1, us_counties$OBS_M6_DIF_G3_v1, us_counties$OBS_M6_DIF_G4_v1) M6_df$OBS_DIF_v2 <- c(us_counties$OBS_M6_DIF_G1_v2, us_counties$OBS_M6_DIF_G2_v2, us_counties$OBS_M6_DIF_G3_v2, us_counties$OBS_M6_DIF_G4_v2) M6_df$OBS_DIF_v3 <- c(us_counties$OBS_M6_DIF_G1_v3, us_counties$OBS_M6_DIF_G2_v3, us_counties$OBS_M6_DIF_G3_v3, us_counties$OBS_M6_DIF_G4_v3)  # Compensate the different numbers of observed and expected cases caused by decimals total_dif_v1 <- sum(EXP)-sum(M6_df$OBS_DIF_v1) total_dif_v2 <- sum(EXP)-sum(M6_df$OBS_DIF_v2) total_dif_v3 <- sum(EXP)-sum(M6_df$OBS_DIF_v3)  if(total_dif_v1>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M6_df$OBS_DIF_v1[r_ids] <- M6_df$OBS_DIF_v1[r_ids] + 1 }else if(total_dif_v1<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v1))   M6_df$OBS_DIF_v1[r_ids] <- M6_df$OBS_DIF_v1[r_ids] - 1 }  if(total_dif_v2>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M6_df$OBS_DIF_v2[r_ids] <- M6_df$OBS_DIF_v2[r_ids] + 1 }else if(total_dif_v2<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v2))   M6_df$OBS_DIF_v2[r_ids] <- M6_df$OBS_DIF_v2[r_ids] - 1 }  if(total_dif_v3>0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M6_df$OBS_DIF_v3[r_ids] <- M6_df$OBS_DIF_v3[r_ids] + 1 }else if(total_dif_v3<0){   r_ids <- sample(1:nrow(M2_df), abs(total_dif_v3))   M6_df$OBS_DIF_v3[r_ids] <- M6_df$OBS_DIF_v3[r_ids] - 1 }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://vdak1ng.github.io/INLA.SocialEp/articles/simulation.html","id":"save-data","dir":"Articles","previous_headings":"","what":"Save Data","title":"Simulation Study - Data Creation","text":"      Lastly, save necessary objects using analysis part results part.","code":"save(M0_df, M1_df, M2_df, M3_df, M4_df, M5_df, M6_df, W, graph, us_counties, file=\"./Datos/sim_data.Rdata\")  sp_object <- us_counties %>% select(geometry, NAME, NAMELSAD,                                      group1_dif_risk, group2_dif_risk, group3_dif_risk, group4_dif_risk, group1_sim_risk, group2_sim_risk, group3_sim_risk, group4_sim_risk,                                      Temp_Scale, POP_DENS_Scale) sp_object$ind.ef.g2 <- ind.ef.g2 sp_object$ind.ef.g1 <- ind.ef.g1 sp_object$ind.ef.g3 <- ind.ef.g3 sp_object$ind.ef.g4 <- ind.ef.g4 save(sp_object, file=\"./Datos/sp_object.Rdata\") save(data_risk, file=\"./Datos/risk_sim.Rdata\")"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Pablo Escobar-Hernández. Author, maintainer. Francisco Palmí-Perales. Author. Antonio López-Quílez. Author.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Escobar-Hernández P, Palmí-Perales F, López-Quílez (2025). INLA.SocialEp: Implementation Advanced Social Disease Mapping Techniques INLA. R package version 1.1, https://github.com/VdaK1NG/INLA.SocialEp.","code":"@Manual{,   title = {INLA.SocialEp: Implementation of Advanced Social Disease Mapping Techniques in INLA},   author = {Pablo Escobar-Hernández and Francisco Palmí-Perales and Antonio López-Quílez},   year = {2025},   note = {R package version 1.1},   url = {https://github.com/VdaK1NG/INLA.SocialEp}, }"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"inlasocialep-","dir":"","previous_headings":"","what":"Implementation of Advanced Social Disease Mapping Techniques in INLA","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"Package includes series functions acting wrapper several disease mapping methods applied social epidemiology INLA, described Escobar-Hernández et al. (2025). See website information, documentation, examples.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"can install latest development version GitHub:","code":"install.packages(\"remotes\") remotes::install_github(\"VdaK1NG/INLA.SocialEp\")"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"dependencies","dir":"","previous_headings":"Installation","what":"Dependencies","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"-Imports: dplyr, ggraph, spdep, ggplot2, gridExtra, broom, sf, tidyr, scales, SUMMER -Suggests: assertthat, doFuture, forcats","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"Check Example vignette quick start tutorial. interested datasets simulated, feel free check -depth description Simulation Study - Data Creation vignette. -depth discussion, read /take look reference documentation.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"help--contributing","dir":"","previous_headings":"","what":"Help & Contributing","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"come across bug, open issue include minimal reproducible example.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"INLA.SocialEp package licensed MIT license. Text images included repository, including INLA.SocialEp logo, licensed CC 4.0 license.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Implementation of Advanced Social Disease Mapping Techniques in INLA","text":"cite INLA.SocialEp publications, use: BibTeX entry LaTeX users :","code":"@Manual{,   title = {INLA.SocialEp: Implementation of Advanced Social Disease Mapping Techniques in INLA},   author = {Pablo Escobar-Hernández and Francisco Palmí-Perales and Antonio López-Quílez},   year = {2025},   note = {R package version 1.1, commit 0edbfae61f99d7d65045fd9be9dccfd2327445bc},   url = {https://github.com/VdaK1NG/INLA.SocialEp}, }"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MARB.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate MARB between fitted values in INLA and simulated values — inla.MARB","title":"Calculate MARB between fitted values in INLA and simulated values — inla.MARB","text":"function estimates Mean Absolute Relative Bias fitted values INLA simulated values","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MARB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate MARB between fitted values in INLA and simulated values — inla.MARB","text":"","code":"inla.MARB(fit_values, sim_values, n.sim = 1)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MARB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate MARB between fitted values in INLA and simulated values — inla.MARB","text":"fit_values Mean fitted values INLA models sim_values Vector simulated values n.sim Number simulated datasets","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MARB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate MARB between fitted values in INLA and simulated values — inla.MARB","text":"Value estimated MARB","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MRRMSE.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate MRRMSE between fitted values in INLA and simulated values — inla.MRRMSE","title":"Calculate MRRMSE between fitted values in INLA and simulated values — inla.MRRMSE","text":"function estimates Mean Relative Root Mean Prediction Error fitted values INLA simulated values","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MRRMSE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate MRRMSE between fitted values in INLA and simulated values — inla.MRRMSE","text":"","code":"inla.MRRMSE(fit_values, sim_values, n.sim = 1)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MRRMSE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate MRRMSE between fitted values in INLA and simulated values — inla.MRRMSE","text":"fit_values Mean fitted values INLA models sim_values Vector simulated values n.sim Number simulated datasets","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MRRMSE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate MRRMSE between fitted values in INLA and simulated values — inla.MRRMSE","text":"Value estimated MRRMSE","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedARB.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate MedARB between fitted values in INLA and simulated values — inla.MedARB","title":"Calculate MedARB between fitted values in INLA and simulated values — inla.MedARB","text":"function estimates Median Absolute Relative Bias fitted values INLA simulated values","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedARB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate MedARB between fitted values in INLA and simulated values — inla.MedARB","text":"","code":"inla.MedARB(fit_values, sim_values, n.sim = 1)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedARB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate MedARB between fitted values in INLA and simulated values — inla.MedARB","text":"fit_values Mean fitted values INLA models sim_values Vector simulated values n.sim Number simulated datasets","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedARB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate MedARB between fitted values in INLA and simulated values — inla.MedARB","text":"Value estimated MedARB","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedRRMSE.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate MedRRMSE between fitted values in INLA and simulated values — inla.MedRRMSE","title":"Calculate MedRRMSE between fitted values in INLA and simulated values — inla.MedRRMSE","text":"function estimates Median Relative Root Mean Prediction Error fitted values INLA simulated values","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedRRMSE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate MedRRMSE between fitted values in INLA and simulated values — inla.MedRRMSE","text":"","code":"inla.MedRRMSE(fit_values, sim_values, n.sim = 1)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedRRMSE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate MedRRMSE between fitted values in INLA and simulated values — inla.MedRRMSE","text":"fit_values Mean fitted values INLA models sim_values Vector simulated values n.sim Number simulated datasets","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.MedRRMSE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate MedRRMSE between fitted values in INLA and simulated values — inla.MedRRMSE","text":"Value estimated MedRRMSE","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.SpANOVA.2x2.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2","title":"Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2","text":"function wrapper multidimensional spatial factor models INLA, using sequential shared spatial effects nested structure discussed AÑADIR REFERENCIA. DISCLAIMER: Observed expected values given specific order. Consider n number areas, first n values (1:n) obs (exp) ones belonging FIRST level (first position lev.fac1 vector argument) FIRST factor (first position fac.names vector argument) FIRST level (first position lev.fac2 vector argument) SECOND factor (second position fac.names vector argument). n following values ((n+1):2n) obs (exp) ones belonging FIRST level (first position lev.fac1 vector argument) FIRST factor (first position fac.names vector argument) SECOND level (second position lev.fac2 vector argument) SECOND factor (second position fac.names vector argument). n following values ((2n+1):3n) obs (exp) ones belonging SECOND level (second position lev.fac1 vector argument) FIRST factor (first position fac.names vector argument) FIRST level (first position lev.fac2 vector argument) SECOND factor (second position fac.names vector argument). n following values ((3n+1):4n) obs (exp) ones belonging SECOND level (second position lev.fac1 vector argument) FIRST factor (first position fac.names vector argument) SECOND level (second position lev.fac2 vector argument) SECOND factor (second position fac.names vector argument). first n values O1, second n values O2, third n values O3 last n values O4","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.SpANOVA.2x2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2","text":"","code":"inla.SpANOVA.2x2(   obs,   exp,   gr,   fac.names = NULL,   lev.fac1 = NULL,   lev.fac2 = NULL,   scale.mod = TRUE,   sp.prior = \"sdunif\",   pc.prec.val = c(1, 0.01),   sp.copy.fixed = TRUE,   save.res = TRUE,   save.random = TRUE,   save.hyper = TRUE )"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.SpANOVA.2x2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2","text":"obs Vector observed values exp Vector expected values gr Graph underlying spatial structure fac.names Names factors included lev.fac1 Levels first factor included lev.fac2 Levels second factor included scale.mod Scale copies random spatial effects , default TRUE sp.prior Select prior random spatial effect, options sdunif pc.prec pc.prec.val Define values por pc prior case chosen. Default values c(1, 0.01) sp.copy.fixed Fix copied values random spatial effects, default TRUE save.res Save fitted values different models, default TRUE save.random Save values adjusted random spatial effects different models, default TRUE save.hyper Save hyperparameter values individual model, default TRUE","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.SpANOVA.2x2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2","text":"List models analyzed summary table common performance metrics.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.full.graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a fully connected graph for INLA — inla.full.graph","title":"Make a fully connected graph for INLA — inla.full.graph","text":"function converts graph islands fully connected graph searching nearest area different nodes connecting , possibility setting threshold connecting several areas within limits.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.full.graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a fully connected graph for INLA — inla.full.graph","text":"","code":"inla.full.graph(   sp_obj,   graph,   thresh = 0.1,   snap = 5e-07,   distance_by = c(\"perimeter\", \"centroid\") )"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.full.graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a fully connected graph for INLA — inla.full.graph","text":"sp_obj Spatial object sp form graph Graph object nb2INLA function snap snap argument function poly2nb distance_by Choices perimeter centroid","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.full.graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a fully connected graph for INLA — inla.full.graph","text":"List including three different objects: adjacency object, edited graph dataframe changes applied","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.null.sp.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract null effects from SR-ANOVA models — inla.null.sp","title":"Extract null effects from SR-ANOVA models — inla.null.sp","text":"function extracts total number null spatial effects inside SR-ANOVA object, one different specifications included.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.null.sp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract null effects from SR-ANOVA models — inla.null.sp","text":"","code":"inla.null.sp(mod, thres = 0.125)"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.null.sp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract null effects from SR-ANOVA models — inla.null.sp","text":"mod Mod file coming SR-ANOVA object thres Threshold sd use spatial effect consider null","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/inla.null.sp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract null effects from SR-ANOVA models — inla.null.sp","text":"SR-ANOVA object summary table updated include null spatial effects","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/pop_data_us_23.html","id":null,"dir":"Reference","previous_headings":"","what":"Population per US County - Year 2023 — pop_data_us_23","title":"Population per US County - Year 2023 — pop_data_us_23","text":"Population per US County - Year 2023","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/pop_data_us_23.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Population per US County - Year 2023 — pop_data_us_23","text":"","code":"pop_data_us_23"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/pop_data_us_23.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Population per US County - Year 2023 — pop_data_us_23","text":"Dataframe Dataframe containing population per US county 2023","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/sim_sp_ef.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated spatial effects — sim_sp_ef","title":"Simulated spatial effects — sim_sp_ef","text":"dataset containing simulated spatial effects.","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/sim_sp_ef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated spatial effects — sim_sp_ef","text":"","code":"sim_sp_ef"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/sim_sp_ef.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated spatial effects — sim_sp_ef","text":"Matrix column contains one simulated spatial effect","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/temp_data_us_23.html","id":null,"dir":"Reference","previous_headings":"","what":"TMean Temperature 2023 — temp_data_us_23","title":"TMean Temperature 2023 — temp_data_us_23","text":"Mean Temperature per US County - Year 2023","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/temp_data_us_23.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TMean Temperature 2023 — temp_data_us_23","text":"","code":"temp_data_us_23"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/temp_data_us_23.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"TMean Temperature 2023 — temp_data_us_23","text":"Dataframe Dataframe containing mean temperature per US county 2023","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/us_county_23.html","id":null,"dir":"Reference","previous_headings":"","what":"US County 2023 — us_county_23","title":"US County 2023 — us_county_23","text":"Spatial object coming shp file US counties","code":""},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/us_county_23.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"US County 2023 — us_county_23","text":"","code":"us_county_23"},{"path":"https://vdak1ng.github.io/INLA.SocialEp/reference/us_county_23.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"US County 2023 — us_county_23","text":"Spatial Object Spatial object US Counties, year 2023","code":""}]
