<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2 • INLA.SocialEp</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply SpANOVA modelization using a wrapper function in INLA — inla.SpANOVA.2x2"><meta name="description" content="This function is a wrapper for multidimensional spatial factor models
in INLA, using a sequential shared spatial effects with nested structure
as discussed in AÑADIR REFERENCIA.

DISCLAIMER: Observed and expected values have to be given in an specific order.
Consider n the number of areas, the first n values (1:n) of the obs (exp) should be the ones belonging to the
FIRST level (the first position of the lev.fac1 vector argument) of the
FIRST factor (the first position of the fac.names vector argument) and
to the FIRST level (the first position of the lev.fac2 vector argument)
of the SECOND factor (the second position of the fac.names vector argument).
The n following values ((n+1):2n) of the obs (exp) should be the ones
belonging to the FIRST level (the first position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the SECOND level (the second position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The n following values ((2n+1):3n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the FIRST level (the first position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The n following values ((3n+1):4n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the SECOND level (the second position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The first n values are O1, the second n values are O2, the third n values
are O3 and the last n values are O4"><meta property="og:description" content="This function is a wrapper for multidimensional spatial factor models
in INLA, using a sequential shared spatial effects with nested structure
as discussed in AÑADIR REFERENCIA.

DISCLAIMER: Observed and expected values have to be given in an specific order.
Consider n the number of areas, the first n values (1:n) of the obs (exp) should be the ones belonging to the
FIRST level (the first position of the lev.fac1 vector argument) of the
FIRST factor (the first position of the fac.names vector argument) and
to the FIRST level (the first position of the lev.fac2 vector argument)
of the SECOND factor (the second position of the fac.names vector argument).
The n following values ((n+1):2n) of the obs (exp) should be the ones
belonging to the FIRST level (the first position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the SECOND level (the second position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The n following values ((2n+1):3n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the FIRST level (the first position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The n following values ((3n+1):4n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the lev.fac1 vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the SECOND level (the second position of the
lev.fac2 vector argument) of the SECOND factor (the second position of
the fac.names vector argument).

The first n values are O1, the second n values are O2, the third n values
are O3 and the last n values are O4"><meta property="og:image" content="https://vdak1ng.github.io/INLA.SocialEp/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">INLA.SocialEp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation Study - Data Creation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/VdaK1NG/INLA.SocialEp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Apply SpANOVA modelization using a wrapper function in INLA</h1>
      <small class="dont-index">Source: <a href="https://github.com/VdaK1NG/INLA.SocialEp/blob/main/R/inla.SpANOVA.2x2.R" class="external-link"><code>R/inla.SpANOVA.2x2.R</code></a></small>
      <div class="d-none name"><code>inla.SpANOVA.2x2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper for multidimensional spatial factor models
in INLA, using a sequential shared spatial effects with nested structure
as discussed in AÑADIR REFERENCIA. <br><br><b>DISCLAIMER:</b> Observed and expected values have to be given in an specific order.
Consider n the number of areas, the first n values (1:n) of the obs (exp) should be the ones belonging to the
FIRST level (the first position of the <b>lev.fac1</b> vector argument) of the
FIRST factor (the first position of the <b>fac.names</b> vector argument) and
to the FIRST level (the first position of the <b>lev.fac2</b> vector argument)
of the SECOND factor (the second position of the <b>fac.names</b> vector argument).
The n following values ((n+1):2n) of the obs (exp) should be the ones
belonging to the FIRST level (the first position of the <b>lev.fac1</b> vector
argument) of the FIRST factor (the first position of the fac.names
vector argument) and to the SECOND level (the second position of the
<b>lev.fac2</b> vector argument) of the SECOND factor (the second position of
the <b>fac.names</b> vector argument).<br><br>
The n following values ((2n+1):3n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the <b>lev.fac1</b> vector
argument) of the FIRST factor (the first position of the <b>fac.names</b>
vector argument) and to the FIRST level (the first position of the
<b>lev.fac2</b> vector argument) of the SECOND factor (the second position of
the <b>fac.names</b> vector argument).<br><br>
The n following values ((3n+1):4n) of the obs (exp) should be the ones
belonging to the SECOND level (the second position of the <b>lev.fac1</b> vector
argument) of the FIRST factor (the first position of the <b>fac.names</b>
vector argument) and to the SECOND level (the second position of the
<b>lev.fac2</b> vector argument) of the SECOND factor (the second position of
the <b>fac.names</b> vector argument).<br><br>
The first n values are O1, the second n values are O2, the third n values
are O3 and the last n values are O4</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">inla.SpANOVA.2x2</span><span class="op">(</span></span>
<span>  <span class="va">obs</span>,</span>
<span>  <span class="va">exp</span>,</span>
<span>  <span class="va">gr</span>,</span>
<span>  fac.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lev.fac1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lev.fac2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale.mod <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sp.prior <span class="op">=</span> <span class="st">"sdunif"</span>,</span>
<span>  pc.prec.val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  sp.copy.fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.res <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save.random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.hyper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.mod.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose.INLA <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obs">obs<a class="anchor" aria-label="anchor" href="#arg-obs"></a></dt>
<dd><p>Vector of observed values</p></dd>


<dt id="arg-exp">exp<a class="anchor" aria-label="anchor" href="#arg-exp"></a></dt>
<dd><p>Vector of expected values</p></dd>


<dt id="arg-gr">gr<a class="anchor" aria-label="anchor" href="#arg-gr"></a></dt>
<dd><p>Graph for the underlying spatial structure</p></dd>


<dt id="arg-fac-names">fac.names<a class="anchor" aria-label="anchor" href="#arg-fac-names"></a></dt>
<dd><p>Names of the factors included</p></dd>


<dt id="arg-lev-fac-">lev.fac1<a class="anchor" aria-label="anchor" href="#arg-lev-fac-"></a></dt>
<dd><p>Levels of the first factor included</p></dd>


<dt id="arg-lev-fac-">lev.fac2<a class="anchor" aria-label="anchor" href="#arg-lev-fac-"></a></dt>
<dd><p>Levels of the second factor included</p></dd>


<dt id="arg-scale-mod">scale.mod<a class="anchor" aria-label="anchor" href="#arg-scale-mod"></a></dt>
<dd><p>Scale copies of random spatial effects or not, default is TRUE</p></dd>


<dt id="arg-sp-prior">sp.prior<a class="anchor" aria-label="anchor" href="#arg-sp-prior"></a></dt>
<dd><p>Select prior for the random spatial effect, options are sdunif and pc.prec</p></dd>


<dt id="arg-pc-prec-val">pc.prec.val<a class="anchor" aria-label="anchor" href="#arg-pc-prec-val"></a></dt>
<dd><p>Define values por the pc prior in case it was chosen. Default values are c(1, 0.01)</p></dd>


<dt id="arg-sp-copy-fixed">sp.copy.fixed<a class="anchor" aria-label="anchor" href="#arg-sp-copy-fixed"></a></dt>
<dd><p>Fix copied values for the random spatial effects, default is TRUE</p></dd>


<dt id="arg-save-res">save.res<a class="anchor" aria-label="anchor" href="#arg-save-res"></a></dt>
<dd><p>Save fitted values or not from the different models, default is TRUE</p></dd>


<dt id="arg-save-random">save.random<a class="anchor" aria-label="anchor" href="#arg-save-random"></a></dt>
<dd><p>Save values adjusted from the random spatial effects or not from the different models, default is TRUE</p></dd>


<dt id="arg-save-hyper">save.hyper<a class="anchor" aria-label="anchor" href="#arg-save-hyper"></a></dt>
<dd><p>Save hyperparameter values from each individual model, default is TRUE</p></dd>


<dt id="arg-save-fixed">save.fixed<a class="anchor" aria-label="anchor" href="#arg-save-fixed"></a></dt>
<dd><p>Save values adjusted from the fixed effects or not from the different models, default is TRUE</p></dd>


<dt id="arg-save-mod-data">save.mod.data<a class="anchor" aria-label="anchor" href="#arg-save-mod-data"></a></dt>
<dd><p>Save modelling data to run the model afterwards</p></dd>


<dt id="arg-verbose-inla">verbose.INLA<a class="anchor" aria-label="anchor" href="#arg-verbose-inla"></a></dt>
<dd><p>Verbose option for INLA, default is FALSE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with all the models analyzed and a summary table with the most common performance metrics.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/VdaK1NG" class="external-link">Pablo Escobar-Hernández</a>, <a href="https://github.com/FranciscoPalmiPerales" class="external-link">Francisco Palmí-Perales</a>, <a href="https://github.com/antoloqui" class="external-link">Antonio López-Quílez</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

